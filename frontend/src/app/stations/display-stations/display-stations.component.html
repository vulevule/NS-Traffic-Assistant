<div class="displayStationsContainer row content">
  <div class="col-12 col-md-3 sidebar-content">
    <ngb-tabset (tabChange)="tabChange()" [activeId]="activeTabId">
      <ngb-tab title="Display stations" id="displayStationsTab">
        <ng-template ngbTabContent>
          <label class="col-12 col-form-label">
            Currently we have {{ stations.length }} stations in total.
          </label>

          <ng-template #rt let-r="result" let-t="term">
            <img
              [src]="'../../../assets/images/' + r.type + '-station.png'"
              class="mr-1"
              style="width: 20px"
            />
            <ngb-highlight [result]="r.name" [term]="t"></ngb-highlight>
          </ng-template>

          <form #directionsForm="ngForm">
            <label class="col-12 col-form-label"
              >Display:

              <div class="btn-group btn-group-toggle">
                <label class="btn-primary" ngbButtonLabel>
                  <input
                    type="checkbox"
                    ngbButton
                    [(ngModel)]="displayType.bus"
                    name="displayBus"
                  />
                  Bus
                </label>
                <label class="btn-primary" ngbButtonLabel>
                  <input
                    type="checkbox"
                    ngbButton
                    [(ngModel)]="displayType.metro"
                    name="displayMetro"
                  />
                  Metro
                </label>
                <label class="btn-primary" ngbButtonLabel>
                  <input
                    type="checkbox"
                    ngbButton
                    [(ngModel)]="displayType.tram"
                    name="displayTram"
                  />
                  Tram
                </label>
              </div>
            </label>
            <!-- <div class="form-group row search-item">
                <label for="displayBus" class="col-12 col-xl-2 col-form-label">Bus</label>
                <input type="checkbox" id="displayBus" name="displayBus">
      
                <label for="displayTram" class="col-12 col-xl-2 col-form-label">Tram</label>
                <input type="checkbox" id="displayTram" name="displayTram">
      
                <label for="displayMetro" class="col-12 col-xl-2 col-form-label">Metro</label>
                <input type="checkbox" id="displayMetro" name="displayMetro">
            </div> -->

            <!-- <label for="stname" class="col-12 col-form-label"
              >Search by name</label
            > -->
            <div class="search-item ">
              <input
                #stname
                type="text"
                id="stname"
                class="form-control"
                name="stname"
                placeholder="Search by name"
                [(ngModel)]="modelSearchName"
                [ngbTypeahead]="search"
                [resultTemplate]="rt"
                [inputFormatter]="formatter"
              />
            </div>

            <!--  <label for="end" class="col-12 col-form-label"
              >Search by address</label
            > -->
            <div class="search-item">
              <input
                #staddress
                type="text"
                id="staddress"
                class="form-control"
                name="staddress"
                placeholder="Search by address"
              />
            </div>
          </form>

          <div id="stationCollapseArea" *ngIf="selectedStation && !editStation">
            <label>Selected station: </label>
            <button
              class="close"
              title="Close"
              (click)="selectedStation = undefined"
            >
              x
            </button>
            <div class="card">
              <div class="card-body">
                <p>Name: {{ selectedStation ? selectedStation.name : "" }}</p>
                <p>Type: {{ selectedStation ? selectedStation.type : "" }}</p>
                <p>
                  Address:
                  {{ selectedStation ? selectedStation.addressName : "" }}
                </p>
              </div>

              <div class="btn-group">
                <button
                  type="button"
                  class="btn btn-outline-primary"
                  (click)="editStation = selectedStation; markerOnMap = [editStation.xCoordinate, editStation.yCoordinate]"
                >
                  Edit
                </button>
                <button
                  type="button"
                  class="btn btn-danger"
                  (click)="deleteStation(selectedStation)"
                >
                  Delete
                </button>
              </div>
            </div>
          </div>

          <div id="stationCollapseArea" *ngIf="editStation">
            <label>Edit station: </label>
            <button
              class="close"
              title="Close"
              (click)="editStation = undefined; removeMarkers()"
            >
              x
            </button>
            <div class="card">
              <div class="card-body">
                <p>Type: {{ editStation ? editStation.type : "" }}</p>
                <div class="search-item">
                  <label class="col-form-label"> Name: </label>

                  <input
                    #stnameEdit
                    type="text"
                    id="stnameEdit"
                    class="form-control"
                    name="stnameEdit"
                    placeholder="Enter station name"
                    [(ngModel)]="editStation.name"
                  />
                </div>

                <div class="search-item">
                  <label class="col-form-label"> Address: </label>
                  <input
                    type="text"
                    id="streetEdit"
                    class="form-control"
                    name="street"
                    placeholder="Enter street"
                    [(ngModel)]="editStation.addressName"
                  />

                  <input
                    type="text"
                    id="cityEdit"
                    class="form-control"
                    name="streetEdit"
                    placeholder="Enter city"
                    [(ngModel)]="editStation.addressCity"
                  />

                  <input
                    type="number"
                    id="zipEdit"
                    class="form-control"
                    name="streetEdit"
                    placeholder="Enter zip"
                    [(ngModel)]="editStation.addressZip"
                  />
                </div>

                <div class="search-item ">
                  <label class="col-form-label"> Location: </label>
                  <input
                    #stlocEdit
                    type="text"
                    id="stlocEdit"
                    readonly
                    class="form-control"
                    name="stlocEdit"
                    [(ngModel)]="markerOnMap"
                    placeholder="Choose location on map"
                  />
                </div>
              </div>

              <div class="btn-group">
                <button
                  type="button"
                  class="btn"
                  (click)="editStation = undefined; removeMarkers()"
                >
                  Cancel
                </button>
                <button
                  type="button"
                  class="btn btn-primary"
                  (click)="updateStation(editStation)"
                >
                  Save
                </button>
              </div>
            </div>
          </div>

          <hr />
          <label>Stations:</label>

          <div id="routes">
            <div
              *ngFor="
                let station of (stations
                  | filterByType: displayType
                  | filterByName: stname.value
                  | filterByAddress: staddress.value)
              "
              class="row route"
              (click)="selectStation(station)"
            >
              <div class="col-2 estimated-time">
                <img
                  src="../../../assets/images/{{ station.type }}-station.png"
                  style="width: 40px"
                />
              </div>

              <div class="col-10 estimated-time">
                <span>{{ station.name }}</span>
                <span>{{ station.addressName }}</span>
              </div>
            </div>
          </div>
        </ng-template>
      </ngb-tab>

      <ngb-tab title="Create new" id="createStationTab">
        <ng-template ngbTabContent>
          <form #createForm="ngForm">
            <label class="col-12 col-form-label"
              >Choose type:

              <div
                class="btn-group btn-group-toggle"
                ngbRadioGroup
                name="radioBasic"
                [(ngModel)]="newStation.type"
              >
                <label ngbButtonLabel class="btn-primary">
                  <input ngbButton type="radio" value="BUS" /> Bus
                </label>
                <label ngbButtonLabel class="btn-primary">
                  <input ngbButton type="radio" value="TRAM" /> Tram
                </label>
                <label ngbButtonLabel class="btn-primary">
                  <input ngbButton type="radio" value="METRO" /> Metro
                </label>
              </div>
            </label>

            <label for="stnameNew" class="col-12 col-form-label"
              >Enter station name:
            </label>
            <div class="search-item ">
              <input
                #stnameNew
                type="text"
                id="stnameNew"
                class="form-control"
                name="stnameNew"
                placeholder="Enter station name"
                [(ngModel)]="newStation.name"
              />
            </div>

            <label for="street" class="col-12 col-form-label"
              >Enter address:
            </label>
            <div class="search-item">
              <input
                type="text"
                id="street"
                class="form-control"
                name="street"
                placeholder="Enter street"
                [(ngModel)]="newStation.addressName"
              />

              <input
                type="text"
                id="city"
                class="form-control"
                name="street"
                placeholder="Enter city"
                [(ngModel)]="newStation.addressCity"
              />

              <input
                type="number"
                id="zip"
                class="form-control"
                name="street"
                placeholder="Enter zip"
                [(ngModel)]="newStation.addressZip"
              />
            </div>

            <label for="stlocNew" class="col-12 col-form-label"
              >Choose location on map:
            </label>
            <div class="search-item ">
              <input
                #stlocNew
                type="text"
                id="stlocNew"
                readonly
                class="form-control"
                name="stlocNew"
                [(ngModel)]="markerOnMap"
                placeholder="Choose location on map"
              />
            </div>
            <hr />
            <button
              type="button"
              class="btn btn-outline-primary"
              (click)="createStation(newStation)"
            >
              Create
            </button>
          </form>
          {{ newStation | json }}
        </ng-template>
      </ngb-tab>
    </ngb-tabset>
  </div>

  <div class="col-12 col-md-9 map-content">
    <div class="legend">
      <div class="legend-title"><span>Legend:</span></div>
      <div class="legend-bus"><span>Bus</span></div>
    </div>
    <div id="map" class="map"></div>
  </div>
</div>
